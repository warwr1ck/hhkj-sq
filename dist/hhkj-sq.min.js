/* !
* hhkj-sq.js v1.3.1
* (c) 2017 wanglk<warwr1ck@126.com>
* Released under the MIT License.
*/

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.HhkjSq=t.HhkjSq||{})}(this,function(t){"use strict";function e(t){var e=document.createElement("script");if(t.callback)window[t.callback]=t.success||function(){};else{var o=parseInt(1e6*Math.random())+1e6;t.callback="_jsonpCallback"+o,window[t.callback]=t.success||function(){}}e.onload=function(){this.parentNode.removeChild(this)},e.onerror=function(){this.parentNode.removeChild(this)},document.querySelector("head").appendChild(e),e.src=t.url+"?callback="+t.callback+"&"+n(t.params)}function n(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(n+"="+t[n]);return e.join("&")}function o(){var t=navigator.userAgent;return t.indexOf("Android")>-1||t.indexOf("Linux")>-1?"Android":t.indexOf("iPhone")>-1?"iPhone OS":t.indexOf("Windows Phone")>-1?"Windows Mobile":""}function s(t){var e={};for(var n in t)"pageName"!=n&&"eventName"!=n&&t.hasOwnProperty(n)&&(e[n]=t[n]);return Object.keys(e).map(function(t){return t+"="+e[t]}).join(",")}function i(t){"string"!=typeof t&&"number"!=typeof t||(t={message:t}),new P(t)}function r(t){var e=document.createElement("div");e.className="_sq_toast-wrapper";var n=document.createElement("div");return n.className="_sq_toast--main",n.innerText=t,e.appendChild(n),e}var a,c=window.navigator.userAgent,d=/:[\d]+$/.test(location.host),l=/108sq/i.test(c),u=/android/i.test(c),p=/iphone/i.test(c),h=/pc/i.test(c)&&/108sq/i.test(c),m=window.navigator.userAgent;if(l){var g=m.match(/108sq\/([^\/]*)\/([^\/]*)\/([^\/]*)\/([^\/]*)$/i);a={name:"108sq",version:g?g[1]:"",cityId:g?g[2]:"",channelName:g?g[3]:"",netType:g?g[4]:""}}else a=null;var f=a,w=d?{main:"http://www.108sq.org:920",app:"http://app.108sq.org:920",login:"http://login.108sq.org:807",userop:"http://userop.108sq.org:1204",discuss:"http://discuss.108sq.org:901",discuss1:"http://discuss1.108sq.org:1202",uploadimg:"http://photo.108sq.org:811",showimg:"http://photoshow.108sq.org:814",merchant:"http://sj.108sq.org:703",activity:"http://huodong.108sq.org:815",shuo:"http://shuo.108sq.org:821",shuocdn:"http://shuo.108sq.org:821",dynamic:"http://dynamic.108sq.org:826",mtalk:"http://mtalksvc.108sq.org:831",shop:"http://shop.108sq.org:1505",dynamicnew:"http://dynamic.108sq.org:826",jiangli:"http://jiangli.tc108.org:1505",love:"http://love.108sq.org:1505",pay:"http://pay.108sq.org:1203",friendv2:"http://friendv2.108sq.org:1505",friend:"http://friend.108sq.org:806",pkplugin:"http://pkplugin.108sq.org:1505",business:"http://business.108sq.org:920",message:"http://message.108sq.org:809",businessad:"http://businessad.108sq.org:71",enrolling:"http://enrolling.108sq.org:1505",m:"http://m.108sq.org:920",nodomain:"http://108sq.org:920",mtalksvcv2:"http://mtalksvcv2.108sq.org:831",mtalksvc:"http://mtalksvc.108sq.org:831",common:"http://common.108sq.org:1505",usertxcdn:"http://usertxcdn.108sq.org:920",vote:"http://vote.108sq.org:1505",images:"http://images.108sq.org:920"}:{main:"http://www.108sq.com",app:"http://app.108sq.com",login:"http://login.108sq.com",userop:"http://userop.108sq.com",discuss:"http://discuss.108sq.com",discuss1:"http://discuss.108sq.com",uploadimg:"http://photo.108sq.com",showimg:"http://photoshow.108sq.com",merchant:"http://sj.108sq.com",activity:"http://huodong.108sq.com",shuo:"http://shuo.108sq.com",shuocdn:"http://shuocdn.108sq.com",dynamic:"http://dynamic.108sq.com",mtalk:"http://mtalksvc.tc108.net",shop:"http://shop.108sq.com",dynamicnew:"http://dynamic.108sq.com",jiangli:"http://jiangli.108sq.com",love:"http://love.108sq.com",pay:"http://pay.108sq.com",friendv2:"http://friendv2.108sq.com",friend:"http://friend.108sq.com",pkplugin:"http://pkplugin.108sq.com",business:"http://business.108sq.com",message:"http://message.108sq.com",businessad:"http://businessad.108sq.com",enrolling:"http://enrolling.108sq.com",m:"http://m.108sq.com",nodomain:"http://108sq.com",mtalksvcv2:"http://mtalksvcv2.sq108.net",mtalksvc:"http://mtalksvc.sq108.net",common:"http://common.108sq.com",usertxcdn:"http://usertxcdn.108sq.com",vote:"http://vote.108sq.com",images:"http://images.108sq.com"},v=function(t){var e={type:"GET",url:"",waiting:"",params:{},success:null,error:null,complete:null,isNeedDecode:!1},n={};for(var o in e)n[o]=t.hasOwnProperty(o)?t[o]:e[o];var s=parseInt(1e12*Math.random()+1e12),i="",r="",a="";n.success&&(i="APP_CALLBACK_SUCCESS_"+s,window[i]=function(t){"string"==typeof t&&(t=JSON.parse(t)),n.success&&n.success.call(window,t)}),n.error&&(r="APP_CALLBACK_ERROR_"+s,window[r]=function(){n.error&&n.error.call(window)}),n.complete&&(a="APP_CALLBACK_COMPLETE_"+s,window[a]=function(){n.complete&&n.complete(window)});var c={type:n.type.toUpperCase(),url:n.url,waiting:n.waiting,params:function(t){var e=[];for(var n in t)e.push(n+"="+t[n]);return e.join("&")}(n.params),success:i,error:r,complete:a,isNeedDecode:n.isNeedDecode};this._callMethod("ajax",JSON.stringify(c))};h&&(v=function(t){var e={url:"",type:"GET",params:{},waiting:"",headers:{"Access-Token":"DEBUG TOKEN"},success:null,complete:null,error:null};for(var n in e)t[n]=t.hasOwnProperty(n)?t[n]:e[n];var o=new XMLHttpRequest;o.onreadystatechange=function(){if(4==o.readyState)if(t.complete&&t.complete(),o.status>=200&&o.status<400){var e=JSON.parse(o.responseText);t.success&&t.success.call(window,e)}else t.error&&t.error()},"GET"===t.type?(o.open("GET",t.url+"?"+function(t){var e=[];for(var n in t)e.push(n+"="+t[n]);return e.join("&")}(t.params),!0),o.setRequestHeader("Access-Token",t.headers["Access-Token"]),o.send()):"POST"===t.type&&(o.open("POST",t.url,!0),o.setRequestHeader("Access-Token",t.headers["Access-Token"]),o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.send(t.params))});var y=v,q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},b=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),S=function(t){var e={url:"",waiting:"",maxwidth:0,quality:100,dataType:"json",params:{},start:null,cancel:null,success:null,failure:null,complete:null},n={};for(var o in e)n[o]=t.hasOwnProperty(o)?t[o]:e[o];var s=parseInt(1e12*Math.random()+1e12),i="",r="",a="",c="",d="";n.start&&(i="APP_UPLOAD_CALLBACK_START_"+s,window[i]=function(){n.start&&n.start(window)}),n.cancel&&(r="APP_UPLOAD_CALLBACK_CANCEL_"+s,window[r]=function(){n.cancel&&n.cancel(window)}),n.complete&&(d="APP_UPLOAD_CALLBACK_COMPLETE_"+s,window[d]=function(){n.complete&&n.complete(window)}),n.success&&(a="APP_UPLOAD_CALLBACK_SUCCESS_"+s,window[a]=function(t){"json"==n.dataType&&"object"!==(void 0===t?"undefined":q(t))?t=JSON.parse(t):"text"==n.dataType&&"object"==(void 0===t?"undefined":q(t))&&(t=JSON.stringify(t)),n.success&&n.success.call(window,t)}),n.failure&&(c="APP_UPLOAD_CALLBACK_FAILURE_"+s,window[c]=function(t){"json"==n.dataType&&"object"!==(void 0===t?"undefined":q(t))?t=JSON.parse(t):"text"==n.dataType&&"object"==(void 0===t?"undefined":q(t))&&(t=JSON.stringify(t)),n.failure&&n.failure.call(window,t)}),n.complete&&(d="APP_CALLBACK_COMPLETE_"+s,window[d]=function(){n.complete&&n.complete(window)});var l={url:n.url,waiting:n.waiting,params:function(t){var e=[];for(var n in t)e.push(n+"="+t[n]);return e.join("&")}(n.params),maxwidth:n.maxwidth,quality:n.quality,start:i,cancel:r,success:a,failure:c,complete:d};this._callMethod("openUpload",JSON.stringify(l))},A=void 0;if(l)A=function(t){return this._callMethod("webStatistics",JSON.stringify(t))};else{var M={log:function(t){var n=s(t);e({url:"http://analytics.108sq.com/log/",params:{version:M.version,os:o(),page:t.pageName,event:t.eventName,args:encodeURIComponent(n)},callback:"logCallback"})},version:"1.0.0"};A=M.log}var k=A,C={_hasMethod:function(t){return!!window.ChangShuoJSBridge&&!!window.ChangShuoJSBridge[t]},_callMethod:function(t){if(this._hasMethod(t))return window.ChangShuoJSBridge[t].apply(window.ChangShuoJSBridge,Array.prototype.slice.call(arguments).slice(1))},showWaiting:function(t){return this._callMethod("showWaiting",t)},hideWaiting:function(){return this._callMethod("hideWaiting")},showToast:function(t){return this._callMethod("showToast",t)},toLogin:function(t){return this._callMethod("toLogin",t)},getToken:function(){return this._callMethod("getToken")},getEncryptMobile:function(){return this._callMethod("getEncryptMobile")},getEncodeMobileFlag:function(){return this._callMethod("getEncodeMobileFlag")},hideMoreMenu:function(){return this._callMethod("hideMoreMenu")},getUserId:function(){return this._callMethod("getUserId")},getUserName:function(){return this._callMethod("getUserName")},sendMessage:function(t){return this._callMethod("sendMessage",t)},shareWebPageToWeiXin:function(t,e,n,o){return this._callMethod("shareWebPageToWeiXin",t,e,n,o)},shareWebPageToWeiXinFriends:function(t,e,n){return this._callMethod("shareWebPageToWeiXinFriends",t,e,"",n)},shareWebPage:function(t){return this._callMethod("shareWebPage",JSON.stringify(t))},startNewWebView:function(t){if(this._hasMethod("startNewWebView"))return this._callMethod("startNewWebView",t);location.href=t},webStatistics:k,pay:function(t,e){return this._callMethod("pay",t,e)},getSiteDomain:function(){return this._callMethod("getSiteDomain")},ajax:y,openUpload:S,openImage:function(t){return this._callMethod("openImage",t)},appWebShare:function(t){return this._callMethod("appWebShare",JSON.stringify(t))},openImagesWithIndex:function(t){var e={index:t.index||0,images:t.images?t.images.join(","):""};return this._callMethod("openImagesWithIndex",JSON.stringify(e))}};h&&(C.getToken=function(){return"DEBUG TOKEN"},C.getUserId=function(){return"5924"},C.getUserName=function(){return"user_DEBUG"},window.addEventListener("load",function(){window.bridgeEvent=document.createEvent("Event"),window.bridgeEvent.initEvent("ChangJSBridgeReady",!1,!1),document.dispatchEvent(window.bridgeEvent)}));var P=function(){function t(e){_(this,t),this.options=Object.assign({},{message:"",duration:2e3},e),this.init(),this.createStyle()}return b(t,[{key:"init",value:function(){var t=this;this.dom=r(this.options.message),document.body.appendChild(this.dom),setTimeout(function(){t.dom.addEventListener("transitionend",t.destroy.bind(t)),t.dom.className+=" hide"},this.options.duration)}},{key:"destroy",value:function(){document.body.removeChild(this.dom),this.dom.removeEventListener("trasnitioned",this.destroy)}},{key:"createStyle",value:function(){var t=document.getElementById("_sq_toast_style");t||(t=document.createElement("style"),t.id="_sq_toast_style",t.innerHTML=["._sq_toast-wrapper{","position:fixed;","left: 0;","bottom: 15%;","width:100%;","box-sizing: border-box;","text-align:center;","-webkit-transform: translateY(-50%);","transform: translateY(-50%);","-webkit-transition: opacity .5s;","transition: opacity .5s;","z-index: 999;","}","._sq_toast-wrapper.hide{","opacity: 0;","}","._sq_toast--main{","display: inline-block;","background: rgba(0,0,0,.4);","color: #fff;","font-size: 14px;","padding: 4px 10px;","border-radius: 99px;","word-break: break-all;","box-sizing: border-box;","max-width: 60%;","text-align: center;","}"].join(""),document.head.appendChild(t))}}]),t}();t.isAndroid=u,t.isIPhone=p,t.isPCDebug=h,t.appInfo=f,t.hosts=w,t.app=C,t.toast=i,Object.defineProperty(t,"__esModule",{value:!0})});
